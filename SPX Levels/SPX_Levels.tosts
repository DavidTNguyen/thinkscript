# === SPX Levels: Trading Bias & Structure ===
# Updated: November 15, 2025
# 
# TRADING BIAS:
# Above 6635+ = No Bear Bias, buy dips vs. Bull Star
# Below 6880+ = No Bull Bias, fade rallies vs. Bear Star
# Trade W-shape swings until either boundary is broken on high volume
#
# SENTIMENT METER:
# 6635+ & above = Cautious Bullish - Dip buys allowed, scale out at intermediate strikes
# 6725-6765 = Neutral Chop - Scalps only, Greeks in play, both directions
# 6825-6880+ = Bearish Pressure - Short rallies, avoid breakout longs unless volume spike confirms
# Below 6635- = High Bearish - Swing shorts toward lower structure
#
# VISUAL RANGE MAP:
# Rally Continuation Zone
# 6880+ = Bear Star (Major Short Zone)
# 6825 = Small Bear Star
# 6765 = Intermediate Strike
# 6725 = "Greek Chase" Strike - Scalps only
# 6705 = Gap-Down Play Zone
# 6695 = Dead Volume Dip Buy Area
# 6635 = Bull Star (Major Long Zone / Buy Support)
# 6620 = Lower Range Edge
# Breakdown = Waterfall Risk

# === RESISTANCE LEVELS ===
input level1 = 6880; # R1 - ðŸ» * (Major Short Zone) - No ðŸ‚ Bias
input level1_thickness = 5;
input level2 = 6825; # R2 - Small ðŸ» *
input level2_thickness = 3;
input level3 = 6765; # R3 - Intermediate Strike
input level3_thickness = 3;
input level4 = 6725; # R4 - "Greek Chase" Strike - Scalps only
input level4_thickness = 2;

# === NEUTRAL ZONE ===
input level5 = 6705; # N1 - Gap-ðŸ”» Play Zone
input level5_thickness = 2;
input level6 = 6695; # N2 - Dead Volume Dip Buy Area
input level6_thickness = 2;

# === SUPPORT LEVELS ===
input level7 = 6635; # S1 - ðŸ‚ * (Major Long Zone / Buy Support) - No ðŸ» Bias
input level7_thickness = 5;
input level8 = 6620; # S2 - Lower Range Edge
input level8_thickness = 3;

# Alert Settings
input enableAlerts = yes;
input alertSensitivity = 0.5;

# Label Visibility
input showLabels = yes;

# Fixed bubble logic - show only on last bar
def isLastBar = IsNaN(close[-1]) and !IsNaN(close);

# === RESISTANCE ===
plot L1 = level1;
L1.SetDefaultColor(Color.RED);
L1.SetLineWeight(level1_thickness);
L1.SetStyle(Curve.FIRM);

plot L2 = level2;
L2.SetDefaultColor(Color.ORANGE);
L2.SetLineWeight(level2_thickness);
L2.SetStyle(Curve.FIRM);

plot L3 = level3;
L3.SetDefaultColor(Color.YELLOW);
L3.SetLineWeight(level3_thickness);
L3.SetStyle(Curve.FIRM);

plot L4 = level4;
L4.SetDefaultColor(Color.LIGHT_GRAY);
L4.SetLineWeight(level4_thickness);
L4.SetStyle(Curve.SHORT_DASH);

# === NEUTRAL ZONE ===
plot L5 = level5;
L5.SetDefaultColor(Color.CYAN);
L5.SetLineWeight(level5_thickness);
L5.SetStyle(Curve.SHORT_DASH);

plot L6 = level6;
L6.SetDefaultColor(Color.CYAN);
L6.SetLineWeight(level6_thickness);
L6.SetStyle(Curve.FIRM);

# === SUPPORT ===
plot L7 = level7;
L7.SetDefaultColor(Color.GREEN);
L7.SetLineWeight(level7_thickness);
L7.SetStyle(Curve.FIRM);

plot L8 = level8;
L8.SetDefaultColor(Color.MAGENTA);
L8.SetLineWeight(level8_thickness);
L8.SetStyle(Curve.FIRM);

# Chart bubbles - show only on last bar
AddChartBubble(isLastBar, level1, "R1: 6880 - ðŸ» * (Major Short)", Color.RED, yes);
AddChartBubble(isLastBar, level2, "R2: 6825 - Small ðŸ» *", Color.ORANGE, yes);
AddChartBubble(isLastBar, level3, "R3: 6765 - Intermediate Strike", Color.YELLOW, yes);
AddChartBubble(isLastBar, level4, "R4: 6725 - Greek Chase (Scalps Only)", Color.LIGHT_GRAY, yes);
AddChartBubble(isLastBar, level5, "N1: 6705 - Gap-ðŸ”» Play", Color.CYAN, yes);
AddChartBubble(isLastBar, level6, "N2: 6695 - Dead Volume Dip Buy", Color.CYAN, yes);
AddChartBubble(isLastBar, level7, "S1: 6635 - ðŸ‚ * (ðŸ”‘ Long)", Color.GREEN, no);
AddChartBubble(isLastBar, level8, "S2: 6620 - Lower Range Edge", Color.MAGENTA, no);

# === ALERT SYSTEM ===

# CRITICAL: ðŸ» * Alerts (6880 - MOST CRITICAL)
Alert(enableAlerts and close crosses above level1, "SPX ðŸ”º 6880 - ðŸ» * BROKEN! ðŸ‚ BIAS ON!", Alert.BAR, Sound.Ring);
Alert(enableAlerts and close crosses below level1, "SPX ðŸ”» 6880 - NO ðŸ‚ BIAS! Fade rallies vs ðŸ» *", Alert.BAR, Sound.Bell);
Alert(enableAlerts and close >= level1 - alertSensitivity and close <= level1 + alertSensitivity, "SPX Testing 6880 - ðŸ» * - Major Short Zone", Alert.BAR, Sound.Chimes);
Alert(enableAlerts and high[1] >= level1 and close < level1 - 5, "SPX âŒ at 6880 - ðŸ» * HOLDS!", Alert.BAR, Sound.Bell);

# CRITICAL: ðŸ‚ * Alerts (6635 - MOST CRITICAL)
Alert(enableAlerts and close crosses above level7, "SPX ðŸ”º 6635 - NO ðŸ» BIAS! Buy dips vs ðŸ‚ *", Alert.BAR, Sound.Ring);
Alert(enableAlerts and close crosses below level7, "SPX ðŸ”» 6635 - ðŸ‚ * BROKEN! HIGH ðŸ»!", Alert.BAR, Sound.Bell);
Alert(enableAlerts and close >= level7 - alertSensitivity and close <= level7 + alertSensitivity, "SPX Testing 6635 - ðŸ‚ * - Major Long Zone", Alert.BAR, Sound.Chimes);
Alert(enableAlerts and low[1] <= level7 and close > level7 + 5, "SPX BOUNCE from 6635 - ðŸ‚ * HOLDS!", Alert.BAR, Sound.Ring);

# Intermediate Resistance Alerts
Alert(enableAlerts and close crosses above level2, "SPX ðŸ”º 6825 - Small ðŸ» * broken", Alert.BAR, Sound.Ring);
Alert(enableAlerts and close crosses above level3, "SPX ðŸ”º 6765 - Intermediate Strike", Alert.BAR, Sound.Ring);
Alert(enableAlerts and close crosses above level4, "SPX ðŸ”º 6725 - Greek Chase zone", Alert.BAR, Sound.Ring);

# Intermediate Support Alerts
Alert(enableAlerts and close crosses below level8, "SPX ðŸ”» 6620 - LOWER RANGE EDGE! Waterfall Risk!", Alert.BAR, Sound.Bell);
Alert(enableAlerts and close crosses below level6, "SPX ðŸ”» 6695 - Dead Volume area", Alert.BAR, Sound.Bell);
Alert(enableAlerts and close crosses below level5, "SPX ðŸ”» 6705 - Gap-ðŸ”» play zone", Alert.BAR, Sound.Bell);

# Bounce/Rejection Alerts
Alert(enableAlerts and high[1] >= level2 and close < level2 - 3, "SPX REJECTION at 6825 - Small ðŸ» * holds", Alert.BAR, Sound.Bell);
Alert(enableAlerts and high[1] >= level3 and close < level3 - 3, "SPX REJECTION at 6765 - Intermediate Strike holds", Alert.BAR, Sound.Bell);
Alert(enableAlerts and low[1] <= level6 and close > level6 + 3, "SPX BOUNCE from 6695 - Dip buy area holds", Alert.BAR, Sound.Ring);
Alert(enableAlerts and low[1] <= level8 and close > level8 + 3, "SPX BOUNCE from 6620 - Lower range edge holds", Alert.BAR, Sound.Ring);

# W-Shape Swing Alerts
Alert(enableAlerts and close >= level7 and close <= level1, "SPX IN W-SHAPE SWING ZONE (6635-6880) - Trade boundaries", Alert.BAR, Sound.Chimes);

# Status Labels
AddLabel(showLabels and enableAlerts, "Alerts ON", Color.GREEN);
AddLabel(showLabels and !enableAlerts, "Alerts OFF", Color.RED);
AddLabel(showLabels, "ðŸ» *: 6880 | ðŸ‚ *: 6635", Color.WHITE);
AddLabel(showLabels, "Now: " + Round(close, 2), Color.CYAN);

# Trading Bias Labels
AddLabel(showLabels and close > level1, "ðŸ”º 6880 - ðŸ‚ BIAS", Color.GREEN);
AddLabel(showLabels and close >= level7 and close <= level1, "6635-6880 - W-SHAPE SWING ZONE", Color.YELLOW);
AddLabel(showLabels and close < level7, "ðŸ”» 6635 - HIGH ðŸ»", Color.RED);

# Sentiment Labels
AddLabel(showLabels and close >= level7, "Cautious ðŸ‚ - Dip buys allowed", Color.GREEN);
AddLabel(showLabels and close >= level4 and close < level3, "Neutral Chop - Scalps only", Color.YELLOW);
AddLabel(showLabels and close >= level2 and close < level1, "ðŸ» Pressure - Short rallies", Color.ORANGE);
AddLabel(showLabels and close < level7, "High ðŸ» - Swing shorts", Color.RED);

# Action Labels
AddLabel(showLabels and close >= level1 - 5 and close <= level1 + 5, "NEAR ðŸ» * 6880 - Major Short Zone!", Color.RED);
AddLabel(showLabels and close >= level7 - 5 and close <= level7 + 5, "NEAR ðŸ‚ * 6635 - Major Long Zone!", Color.GREEN);
AddLabel(showLabels and close >= level4 and close <= level4 + 10, "Greek Chase Zone - Scalps Only!", Color.LIGHT_GRAY);
AddLabel(showLabels and close >= level6 and close <= level5, "Dead Volume / Gap-ðŸ”» Play Zone", Color.CYAN);
AddLabel(showLabels and close < level8, " ðŸ’£ - ðŸ”» 6620!", Color.MAGENTA);
